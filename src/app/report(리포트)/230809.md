# 2023.08.09(수) 활동기록

## 변경 사항

## 추가 사항

## 활동 목표
- 공동 : 데이터베이스에 칵테일 15개 정도 저장할 예정. 이미지 포함.
- 임채윤
    - 칵테일 페이지에 수정 기능 추가
    - 칵테일 추가 페이지에서 칵테일을 추가할 때, 칵테일을 삭제할 때 페이지가 자동 새로고침이 되었으면 좋겠는데 자꾸 새로고침이 되지않음.  
    자동으로 새로고침되며 바뀐 내용이 화면에 즉각적으로 보이도록 업데이트 할 예정
- 장소현
    - 도수 계산기 페이지 기능 완성
    - 도수 계산기 다시하기 버튼을 눌렀을 때 페이지가 새로고침 됨 -> 값만 비었으면 좋겠음
    - 데이터 이미지 모음

## 구현 사항
- 임채윤
    - 칵테일 레시피 DB내용과 이미지를 매칭함
    - 칵테일 레시피 페이지에 cocktail 데이터베이스 연결 완료
    - 칵테일 레시피 페이지에 데이터 id에 맞게 이미지, 이름, 한줄평, 설명, 맛 등 정보 표현
    - 레시피 페이지 display : Grid를 사용하여 구현함. 미리보기 이미지를 클릭하면 해당 칵테일의 레시피 페이지로 이동하도록 구현
    - 칵테일 추가, 삭제 시에 내용이 새로고침 되지 않던 문제 해결
    - 계산기에서 useRef()를 사용하여 오류가 생긴 Input태그로 focus 이동 되도록 설정하였음 useRef([]) 배열 사용. input 태그에는 ref={el=>inputRef.current[i].focus()=el} 과 같이 입력하였음

- 장소현
    - 도수 계산기 값 변화 저장하는 changeInput 구현
    - 결과 계산해주는 subInput function 구현
    - 도수 계산에 오류를 주는 상황들 경고 구현


## 추후 목표


## 오늘의 삽질
- 장소현
    - **계산기 ChangeInput()문제**
    - 저번에 발생했던 똑같이 복사되지 않고 하나가 더 생기는 문제의 이유 : splice(item.id-1,0,{id : item.id, degree:Number(event.target.value), amount : item.amount})라고 작성을 해서 기존 배열의 id가 1 2였다면 splice 이후에 아무 것도 삭제되지 않고 변경된 것이 추가로 생겨 id가 1 1 2가 된 것이 문제였다.   
    => splice(item.id-1,1,{~})로 변경해서 해결 
    - **만들어진 계산기 테스트 중 추가를 하다가 위에 있던 것을 삭제하고 아래에 쓰면 에러가 발생**
    : splice(start, delete, change)에서 첫 번째 인자가 배열의 index 값을 나타내는 것이어서 생긴 문제  
    문제 상황 : id 4를 삭제하고 id 6에 글을 추가하길 원함  splice(5,1,{~})(item.id = 6, start는 item.id-1이므로 5)  
    [index | id degree amount]일 때(degree, amount는 임시 값을 넣은 것임)  
    [0 | 1 1 1]  
    [1 | 2 2 2]  
    [2 | 3 3 3]  
    [3 | 4 4 4]   
    [4 | 5 5 5]  
    [5 | 6    ] 에서 id 4를 삭제하면   
       
    [0 | 1 1 1]  
    [1 | 2 2 2]  
    [2 | 3 3 3]  
    [3 | 4 4 4] x    
    [3 | 5 5 5]  
    [4 | 6    ] 으로 변경되어서 splice할 index 5가 존재하지 않게 되면서 생긴 문제였다.  
    해결 : ChangeInput(event=>{})를 ChangeInput((event,i)=>{})로 변경하여 index 값을 추가 시키고 splice(i,1,{~})으로 변경하여 해결    
    - **계산기 오류 생각**
    - 계산기 경고창이 떠야 할 때를 다음 네 가지로 분류 함
    1. 제출 할 때 경고하기
    2. 여기에 도수 중 100이 넘는애가 있으면 경고하게
    3. 도수, 양 0보다 작을 때 경고하기(음수 일 경우)
    4. sumAmount는 0이면 안된다.
    경고 창이 뜨면서 해당 부분을 지워버릴지 경고만 할지 고민하다가 경고하고 해당 부분을 가리키는 것으로 결정  
    - 위의 상황들을 경고할 때 어떻게 처리할 지 고민
    isOver(도수값은 0이상 100이하 여야 함)=false, isZero(총 양이 0 이상이어야 함)=false를 만들어 문제가 생겼을 때 true로 만들고 alert로 경고하도록 만듦
    - **계산하기를 눌렀을 때 결과랑 다시하기가 뜨고 다시하기를 눌렀을 때 결과랑 다시하기 버튼이 사라지고 계산하기 버튼이 나타나도록 해야함**
        - 다시하기 버튼을 누르면 <a href>를 사용해 새로고침이 되도록 구현했지만 새로고침 없이 값이 지워지게 구현하고 싶어 다시 도전하기로 함  
    - 배열은 초기화 했지만 기존에 썼던 값이 지워지지 않는 오류가 남
    - 실패..

- 임채윤
    - 자꾸 칵테일 정보를 삭제하든 추가하든 router를 사용한 어떤짓을 해도 새로고침이 되지 않는 문제가 발생하였음
    - 이걸로 꽤나 오래 삽질했는데... 결론적으로 해결한 방법을 이야기하면 useEffect 문제였다.
    - 데이터 fetch를 컨텐츠가 바뀔때마다 해야하는데 초기에만 fetch하고 데이터가 추가되거나 삭제될때는 fetch를 안해서 변하지 않은 컨텐츠만 계속하여 새로고침시키고 있던 것이었다.
    - f5를 눌러서 새로고침 시에 컨텐츠가 바뀐 이유는 Component가 다시 실행되어 초기 useEffect구문이 데이터를 가져왔기 때문... 아무튼 해결했다.